{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from \"axios\";\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst galleryBox = document.querySelector('.gallery-box');\nconst loaderTop = document.querySelector('.loader-top');\nconst loaderBottom = document.querySelector('.loader-bottom');\nconst input = document.querySelector('input');\nconst loadImg = document.querySelector('.load-image');\n\nlet page = 1;\n\nlet per_page = 40;\n\nlet q = \"\";\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    nav: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n    close: true,\n    enableKeyboard: true,\n    docClose: true,\n  });\n\n  form.addEventListener('submit', onSubmit);\nloadImg.addEventListener('click', loadMore);\n\nfunction searchImg(q, page) {\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    \n    return axios.get(\"/api/\", {\n        params: {\n            key: '41901315-991c01eb87449dbd0d544d02b',\n            q,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            page,\n            per_page,\n        }\n    });\n}\n\nfunction renderImg(hits = []){\n    return hits.reduce((html, img) => {\n                            return (\n                              html +\n                              `<li class=\"gallery-item\">\n                          <a href=${img.largeImageURL}> \n                            <img class=\"gallery-img\" src =${img.webformatURL} alt=${img.tags}/>\n                          </a>\n                          <div class=\"gallery-text-box\">\n                            <p>Likes: <span class=\"text-value\">${img.likes}</span></p>\n                            <p>views: <span class=\"text-value\">${img.views}</span></p>\n                            <p>comments: <span class=\"text-value\">${img.comments}</span></p>\n                            <p>downloads: <span class=\"text-value\">${img.downloads}</span></p>\n                        </div>\n                        </li>`\n                            );\n                          }, '');\n}\n\nasync function onSubmit(event){\n    event.preventDefault();\n    loaderTop.style.display = 'block';\n    loadImg.style.display = 'none';\n\n    q = event.target.elements.search.value.trim();\n    if (!q) {\n        gallery.innerHTML = '';\n        iziToast.info({\n          position: 'topRight',\n          message: 'Error enter any symbols',\n        });\n        loaderTop.style.display = 'none';\n        return;\n      }\n\n\n      try {\n        const {\n          data: { hits, totalHits },\n        } = await searchImg(q, page);\n\n        if (hits.length > 0) {\n          loaderTop.style.display = 'none';\n          gallery.innerHTML = renderImg(hits);\n          lightbox.refresh();\n          iziToast.success({\n            position: 'topRight',\n            message: `We found ${totalHits} photos`,\n          });\n          loadImg.style.display = 'block';\n        } else {\n          gallery.innerHTML = '';\n          iziToast.error({\n            position: 'topRight',\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n          });\n        }\n\n        if (totalHits <= per_page) {\n          loadImg.style.display = 'none';\n        }\n\n      } catch (error) {\n        console.log(error);\n      }\n      finally {\n        loaderTop.style.display = 'none';\n        event.target.reset();\n      }\n\n      \n}\n\n\nasync function loadMore(event) {\n  loaderBottom.style.display = 'block';\n  loadImg.style.display = 'none';\n  const listItem = document.querySelector('.gallery-item:first-child');\n  const itemHeight = listItem.getBoundingClientRect().height;\n\n  try {\n    page += 1;\n\n    const {\n      data: { hits, totalHits },\n    } = await searchImg(q, page);\n    const totalPage = Math.ceil(totalHits / per_page);\n\n    loadImg.style.display = 'block';\n    gallery.insertAdjacentHTML('beforeend', renderImg(hits));\n    lightbox.refresh();\n\n    if (page === totalPage) {\n      loadImg.style.display = 'none';\n      return iziToast.info({\n        position: 'topRight',\n        message: `We're sorry, but you've reached the end of search results.`,\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderBottom.style.display = 'none';\n    window.scrollBy({\n      top: 2 * itemHeight,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["form","gallery","loaderTop","loaderBottom","loadImg","page","per_page","q","lightbox","SimpleLightbox","onSubmit","loadMore","searchImg","axios","renderImg","hits","html","img","event","iziToast","totalHits","error","itemHeight","totalPage"],"mappings":"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"}